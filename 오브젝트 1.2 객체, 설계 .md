### 변경에 취약한 코드

가장 큰 문제는 현재 작성된 구조가 변경에 취약하다는 것이다. 위 코드는 청중이 항상 가방에 현금과 초대장을 갖고 있다고 가정한다. 또한 매표소에서는 항상 현금으로 티켓을 판매하며, 매표소에서만 판매원이 티켓을 판매한다고 가정하고 작성된 코드이다. 어느날 청중이 더 이상 가방을 가지고 다니지 않고, 관람객이 신용카드를 이용해서 티켓을 구매한다면? 지류 티켓이 아니라 온라인 방식의 티켓으로 변경된다면?

이렇듯 가정이 깨지는 순간 모든 코드가 일시에 흔들리게 된다.

간단한 예로 더이상 가방을 사용하지 않는다면 어떻게 될까? Audience 클래스에서 Bag을 제거하고 Bag에 직접 접근하는 Theater의 enter 메서드도 연쇄적으로 수정해야한다. 하나의 수정사항이 가져오는 파급 효과가 코드 전체에 걸쳐서 연쇄적으로 발생하는 것을 볼 수 있다.

객체사이의 높은 의존성이 변경에 취약한 결과를 초래했다.

의존성이가져오는 변경에 대한 영향의 전파가 객체 하나 뿐에 그치는 것이 아닌 객체 사이 간 의존성을 갖는 다른 객체에게도 전파될 수 있다는 것이다.

📌 **설계의 목표는 객체 사이의 결합도를 낮춰 변경이 용이한 설계를 만드는 것이어야 한다.**

### 설계 개선하기

**문제 인식하기**

Theater의 enter 메서드는 청중의 가방과 판매원의 매표소에 직접 접근하고 있다.

- 관람객과 판매원이 enter에 의해서 동작하는 수동적인 상태에 놓여 있으며 직관을 벗어나는 구조 때문에
  enter의 의도를 정확히 알 수 없다. 결국 의사소통하지 못하기에 코드가 이해하기 어려워진 것이다.
- 직접 접근한다는 것은 곧 Theater가 Audience와 TicketSeller에 결합된다는 것을 의미한다.
  다시 말해 변경에 취약해진 것이다.

**문제 해결하기**

Theater가 Audience와 TicketSeller에 대해 세세한 부분까지 알지 못하게 정보를 차단한다.

- 관람객이 가방이 있다는 사실, 판매원이 매표소에서 티켓을 판매한다는 사실을 Theater가 알아야 할 필요가 없다.
- 핵심은 관람객이 소극장에 입장하는 것 뿐이기에 관람객이 스스로 현금과 초대장을 처리하고 판매원이 매표소와 판매 요금을 다루게 한다면 문제를 해결 할 수 있을 것이다.

여러 책임을 갖고 있는 Theater의 책임을 나눠 관람객과 판매원에게 자율성을 부여하여 해결하자. 
이를 통해 **SRP(Single Responsibility Principle)를 만족하는 구조로 바꿔보자.**